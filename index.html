<html>
        <head>
            <style>
                body{
                    margin:0;
                    height : 100%;
                    width:100%;
                    font-family : monospace;
                }
                .container>div{
                    font-size:3vh;
                }
                #output{
                    /* height: 320px;
                       width: 480px; */
                    /* margin: 0 10vh; */
                    border: 2px solid black;
                    border-radius: 10px;
                    display: flex;
                    margin-left: calc(50% - 240px);
                }
                input{
                    margin : 5vh 0;
                    width : 30vw;
                    height : 5vh;
                    line-height: 5vh;
                    margin-left : 15vw;
                }
                .container{
                    width : 100vw;
                    height : auto;
                    display : flex;
                    flex-direction : row;
                }

                .container>div{
                    display:flex;
                    flex-direction: column;
                }
                .outputter{
                    width:50vw;
                }
                .inputter{
                    width:50vw;
                    justify-content : space-evenly;
                }
                #pred{
                    margin : 5vh 0;
                    text-align : center;
                }
            </style>
            <script src="tf.min.js"></script>
        </head>
        <body>
            <center>
                <div class='container'>
                    <div class='inputter'>
                        <div>pnr</div>
                        <input type="text" class='pnr'>
                        <div>flight no</div>
                        <input type='text' class='flight_no'>
                        <div>flight op</div>
                        <input type='text' class='flight_op'>
                        <input type="file"  accept="image/*" name="ima" id="file">
                        <input type="submit" id='submit'>
                    </div>  
                   <div class="outputter">
                    <img id="output"/>	
                    <div id="pred"></div>
                   </div>
                    
                </div>
            </center>

          
        </body>
        <script>
            pnr = document.querySelector('.pnr')
            fno = document.querySelector('.flight_no')
            fop = document.querySelector('.flight_op')
            let p,q,r,dataUrl

            var loadFile = async function(event) {
                var image = document.getElementById('output');
                image.src = URL.createObjectURL(event.target.files[0]);
                // const check = tf.browser.fromPixels(image).resizeNearestNeighbor([320, 480]).toFloat().expandDims();
                // console.log(check);
                const pred = document.querySelector('#pred');
                let blob = await fetch(image.src).then(r => r.blob());
                dataUrl = await new Promise(resolve => {
                let reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.readAsDataURL(blob);
                })


                

                    // async function predictor() {
                    //     const model = await tf.loadLayersModel('model/model.json');
                    //     // model.summary();
                    //     const prediction = model.predict(check);
                    //     pred.innerText += prediction;
                    //     prediction.print();
                    // }
                    // predictor();
            }



            inp = document.querySelector('#file');
            sub = document.querySelector('#submit');
            sub.onclick = async () =>{
                let data = {
                        "encoded_string": dataUrl,
                        "pnr": p,
                        "flight_no": q,
                        "flight_op": r
                    }

                    let response = await fetch('https://39u3b3cep7.execute-api.ap-south-1.amazonaws.com/prod/checker', {
                        method: 'POST',
                        headers: {
                        'Content-Type': 'application/json;charset=utf-8'
                        },
                        body: JSON.stringify(data)
                    });

                    let result = await response.json();
                    console.log(result);
                    pred.innerText=result.label;
            }
            inp.onchange = () => loadFile(event);
            pnr.onchange = ()=> p = pnr.value;
            fno.onchange = ()=> q = fno.value;
            fop.onchange = ()=> r = fop.value;
            
        </script>
</html>